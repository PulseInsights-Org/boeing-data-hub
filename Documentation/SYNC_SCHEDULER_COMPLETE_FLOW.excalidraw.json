{
  "type": "excalidraw",
  "version": 2,
  "source": "https://excalidraw.com",
  "elements": [
    {
      "id": "title_main",
      "type": "text",
      "x": 400,
      "y": 20,
      "width": 600,
      "height": 45,
      "text": "BOEING SYNC SCHEDULER - COMPLETE DATA FLOW",
      "fontSize": 36,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent"
    },
    {
      "id": "section1_title",
      "type": "text",
      "x": 50,
      "y": 100,
      "width": 400,
      "height": 30,
      "text": "FLOW 1: PRODUCT PUBLISH (Entry Point)",
      "fontSize": 24,
      "fontFamily": 1,
      "strokeColor": "#e03131",
      "backgroundColor": "transparent"
    },
    {
      "id": "publish_step0",
      "type": "rectangle",
      "x": 50,
      "y": 150,
      "width": 180,
      "height": 60,
      "strokeColor": "#1971c2",
      "backgroundColor": "#a5d8ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "publish_step0_text",
      "type": "text",
      "x": 70,
      "y": 165,
      "width": 140,
      "height": 30,
      "text": "User calls\nPOST /bulk-publish",
      "fontSize": 14,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_p0_p1",
      "type": "arrow",
      "x": 230,
      "y": 180,
      "width": 50,
      "height": 0,
      "strokeColor": "#1971c2",
      "strokeWidth": 2,
      "points": [[0, 0], [50, 0]]
    },
    {
      "id": "publish_step1",
      "type": "rectangle",
      "x": 280,
      "y": 150,
      "width": 180,
      "height": 60,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#b2f2bb",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "publish_step1_text",
      "type": "text",
      "x": 290,
      "y": 160,
      "width": 160,
      "height": 40,
      "text": "READ product_staging\n(get product data)",
      "fontSize": 14,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "publish_step1_db",
      "type": "ellipse",
      "x": 310,
      "y": 220,
      "width": 120,
      "height": 40,
      "strokeColor": "#f08c00",
      "backgroundColor": "#ffec99",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "publish_step1_db_text",
      "type": "text",
      "x": 325,
      "y": 230,
      "width": 90,
      "height": 20,
      "text": "product_staging",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_p1_db",
      "type": "arrow",
      "x": 370,
      "y": 210,
      "width": 0,
      "height": 10,
      "strokeColor": "#2f9e44",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 10]]
    },
    {
      "id": "arrow_p1_p2",
      "type": "arrow",
      "x": 460,
      "y": 180,
      "width": 50,
      "height": 0,
      "strokeColor": "#1971c2",
      "strokeWidth": 2,
      "points": [[0, 0], [50, 0]]
    },
    {
      "id": "publish_step2",
      "type": "rectangle",
      "x": 510,
      "y": 150,
      "width": 180,
      "height": 60,
      "strokeColor": "#9c36b5",
      "backgroundColor": "#eebefa",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "publish_step2_text",
      "type": "text",
      "x": 520,
      "y": 160,
      "width": 160,
      "height": 40,
      "text": "CALL Shopify API\nPOST /products",
      "fontSize": 14,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "publish_step2_api",
      "type": "diamond",
      "x": 540,
      "y": 220,
      "width": 120,
      "height": 50,
      "strokeColor": "#9c36b5",
      "backgroundColor": "#f3d9fa",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "publish_step2_api_text",
      "type": "text",
      "x": 565,
      "y": 235,
      "width": 70,
      "height": 20,
      "text": "Shopify API",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_p2_p3",
      "type": "arrow",
      "x": 690,
      "y": 180,
      "width": 50,
      "height": 0,
      "strokeColor": "#1971c2",
      "strokeWidth": 2,
      "points": [[0, 0], [50, 0]]
    },
    {
      "id": "publish_step3",
      "type": "rectangle",
      "x": 740,
      "y": 150,
      "width": 180,
      "height": 60,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "publish_step3_text",
      "type": "text",
      "x": 750,
      "y": 160,
      "width": 160,
      "height": 40,
      "text": "WRITE product\n(UPSERT with shopify_id)",
      "fontSize": 14,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "publish_step3_db",
      "type": "ellipse",
      "x": 770,
      "y": 220,
      "width": 120,
      "height": 40,
      "strokeColor": "#f08c00",
      "backgroundColor": "#ffec99",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "publish_step3_db_text",
      "type": "text",
      "x": 805,
      "y": 230,
      "width": 50,
      "height": 20,
      "text": "product",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_p3_p4",
      "type": "arrow",
      "x": 920,
      "y": 180,
      "width": 50,
      "height": 0,
      "strokeColor": "#1971c2",
      "strokeWidth": 2,
      "points": [[0, 0], [50, 0]]
    },
    {
      "id": "publish_step4",
      "type": "rectangle",
      "x": 970,
      "y": 150,
      "width": 200,
      "height": 60,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "publish_step4_text",
      "type": "text",
      "x": 980,
      "y": 160,
      "width": 180,
      "height": 40,
      "text": "WRITE product_staging\n(UPDATE shopify_id)",
      "fontSize": 14,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "publish_step4_db",
      "type": "ellipse",
      "x": 1000,
      "y": 220,
      "width": 140,
      "height": 40,
      "strokeColor": "#f08c00",
      "backgroundColor": "#ffec99",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "publish_step4_db_text",
      "type": "text",
      "x": 1020,
      "y": 230,
      "width": 100,
      "height": 20,
      "text": "product_staging",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_p4_p5",
      "type": "arrow",
      "x": 1070,
      "y": 210,
      "width": 0,
      "height": 80,
      "strokeColor": "#1971c2",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 80]]
    },
    {
      "id": "publish_step5",
      "type": "rectangle",
      "x": 970,
      "y": 290,
      "width": 200,
      "height": 80,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffe3e3",
      "fillStyle": "solid",
      "strokeWidth": 3,
      "roundness": { "type": 3 }
    },
    {
      "id": "publish_step5_text",
      "type": "text",
      "x": 980,
      "y": 300,
      "width": 180,
      "height": 60,
      "text": "WRITE sync_schedule\n(INSERT - NEW ENTRY)\nhour_bucket = LEAST LOADED",
      "fontSize": 13,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#c92a2a"
    },
    {
      "id": "publish_step5_db",
      "type": "ellipse",
      "x": 1000,
      "y": 380,
      "width": 140,
      "height": 40,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "publish_step5_db_text",
      "type": "text",
      "x": 1005,
      "y": 390,
      "width": 130,
      "height": 20,
      "text": "product_sync_schedule",
      "fontSize": 11,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "bucket_calc_box",
      "type": "rectangle",
      "x": 1200,
      "y": 290,
      "width": 280,
      "height": 130,
      "strokeColor": "#f08c00",
      "backgroundColor": "#fff9db",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "bucket_calc_title",
      "type": "text",
      "x": 1210,
      "y": 300,
      "width": 260,
      "height": 20,
      "text": "BUCKET CALCULATION (NEW!)",
      "fontSize": 14,
      "fontFamily": 1,
      "strokeColor": "#e67700"
    },
    {
      "id": "bucket_calc_text",
      "type": "text",
      "x": 1210,
      "y": 325,
      "width": 260,
      "height": 90,
      "text": "1. Query COUNT per hour_bucket\n2. Find bucket with MIN products\n3. Assign new product to that bucket\n\nResult: Equal distribution\n(max variance = 1 product)",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_bucket",
      "type": "arrow",
      "x": 1170,
      "y": 330,
      "width": 30,
      "height": 0,
      "strokeColor": "#f08c00",
      "strokeWidth": 2,
      "points": [[0, 0], [30, 0]]
    },
    {
      "id": "section2_title",
      "type": "text",
      "x": 50,
      "y": 480,
      "width": 500,
      "height": 30,
      "text": "FLOW 2: HOURLY DISPATCH (Every Hour at HH:00)",
      "fontSize": 24,
      "fontFamily": 1,
      "strokeColor": "#1971c2",
      "backgroundColor": "transparent"
    },
    {
      "id": "dispatch_trigger",
      "type": "diamond",
      "x": 50,
      "y": 530,
      "width": 140,
      "height": 80,
      "strokeColor": "#5c940d",
      "backgroundColor": "#d8f5a2",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "dispatch_trigger_text",
      "type": "text",
      "x": 70,
      "y": 555,
      "width": 100,
      "height": 30,
      "text": "Celery Beat\nHH:00 trigger",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_d0_d1",
      "type": "arrow",
      "x": 190,
      "y": 570,
      "width": 40,
      "height": 0,
      "strokeColor": "#1971c2",
      "strokeWidth": 2,
      "points": [[0, 0], [40, 0]]
    },
    {
      "id": "dispatch_step1",
      "type": "rectangle",
      "x": 230,
      "y": 530,
      "width": 180,
      "height": 80,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "dispatch_step1_text",
      "type": "text",
      "x": 240,
      "y": 545,
      "width": 160,
      "height": 50,
      "text": "STEP 1: RESET STUCK\nUPDATE sync_schedule\nSET status='pending'\nWHERE stuck > 30min",
      "fontSize": 11,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "dispatch_step1_db",
      "type": "ellipse",
      "x": 260,
      "y": 620,
      "width": 120,
      "height": 35,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffe3e3",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "dispatch_step1_db_text",
      "type": "text",
      "x": 270,
      "y": 628,
      "width": 100,
      "height": 20,
      "text": "sync_schedule",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "dispatch_step1_label",
      "type": "text",
      "x": 380,
      "y": 630,
      "width": 50,
      "height": 15,
      "text": "UPDATE",
      "fontSize": 10,
      "fontFamily": 1,
      "strokeColor": "#e03131"
    },
    {
      "id": "arrow_d1_d2",
      "type": "arrow",
      "x": 410,
      "y": 570,
      "width": 40,
      "height": 0,
      "strokeColor": "#1971c2",
      "strokeWidth": 2,
      "points": [[0, 0], [40, 0]]
    },
    {
      "id": "dispatch_step2",
      "type": "rectangle",
      "x": 450,
      "y": 530,
      "width": 180,
      "height": 80,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#b2f2bb",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "dispatch_step2_text",
      "type": "text",
      "x": 460,
      "y": 545,
      "width": 160,
      "height": 50,
      "text": "STEP 2: QUERY HOUR\nSELECT * FROM\nsync_schedule WHERE\nhour_bucket = current",
      "fontSize": 11,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "dispatch_step2_db",
      "type": "ellipse",
      "x": 480,
      "y": 620,
      "width": 120,
      "height": 35,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#d3f9d8",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "dispatch_step2_db_text",
      "type": "text",
      "x": 490,
      "y": 628,
      "width": 100,
      "height": 20,
      "text": "sync_schedule",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "dispatch_step2_label",
      "type": "text",
      "x": 600,
      "y": 630,
      "width": 40,
      "height": 15,
      "text": "READ",
      "fontSize": 10,
      "fontFamily": 1,
      "strokeColor": "#2f9e44"
    },
    {
      "id": "arrow_d2_d3",
      "type": "arrow",
      "x": 630,
      "y": 570,
      "width": 40,
      "height": 0,
      "strokeColor": "#1971c2",
      "strokeWidth": 2,
      "points": [[0, 0], [40, 0]]
    },
    {
      "id": "dispatch_step3",
      "type": "rectangle",
      "x": 670,
      "y": 530,
      "width": 180,
      "height": 80,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "dispatch_step3_text",
      "type": "text",
      "x": 680,
      "y": 545,
      "width": 160,
      "height": 50,
      "text": "STEP 3: LOCK\nUPDATE sync_schedule\nSET status='syncing'\n(ACQUIRE LOCK)",
      "fontSize": 11,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "dispatch_step3_db",
      "type": "ellipse",
      "x": 700,
      "y": 620,
      "width": 120,
      "height": 35,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffe3e3",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "dispatch_step3_db_text",
      "type": "text",
      "x": 710,
      "y": 628,
      "width": 100,
      "height": 20,
      "text": "sync_schedule",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "dispatch_step3_label",
      "type": "text",
      "x": 820,
      "y": 630,
      "width": 50,
      "height": 15,
      "text": "UPDATE",
      "fontSize": 10,
      "fontFamily": 1,
      "strokeColor": "#e03131"
    },
    {
      "id": "arrow_d3_d4",
      "type": "arrow",
      "x": 850,
      "y": 570,
      "width": 40,
      "height": 0,
      "strokeColor": "#1971c2",
      "strokeWidth": 2,
      "points": [[0, 0], [40, 0]]
    },
    {
      "id": "dispatch_step4",
      "type": "rectangle",
      "x": 890,
      "y": 530,
      "width": 180,
      "height": 80,
      "strokeColor": "#1971c2",
      "backgroundColor": "#a5d8ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "dispatch_step4_text",
      "type": "text",
      "x": 900,
      "y": 545,
      "width": 160,
      "height": 50,
      "text": "STEP 4: QUEUE BATCHES\nCreate batches of 10\nPush to Redis queue\nsync_boeing",
      "fontSize": 11,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "dispatch_step4_redis",
      "type": "rectangle",
      "x": 920,
      "y": 620,
      "width": 120,
      "height": 35,
      "strokeColor": "#f03e3e",
      "backgroundColor": "#ffe3e3",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 2 }
    },
    {
      "id": "dispatch_step4_redis_text",
      "type": "text",
      "x": 945,
      "y": 628,
      "width": 70,
      "height": 20,
      "text": "Redis Queue",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "dispatch_batch_note",
      "type": "text",
      "x": 1080,
      "y": 550,
      "width": 150,
      "height": 40,
      "text": "208 products ÷ 10\n= 21 batch tasks",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#868e96"
    },
    {
      "id": "section3_title",
      "type": "text",
      "x": 50,
      "y": 720,
      "width": 500,
      "height": 30,
      "text": "FLOW 3: BOEING SYNC (Per Batch - Rate Limited 2/min)",
      "fontSize": 24,
      "fontFamily": 1,
      "strokeColor": "#9c36b5",
      "backgroundColor": "transparent"
    },
    {
      "id": "boeing_worker",
      "type": "rectangle",
      "x": 50,
      "y": 770,
      "width": 120,
      "height": 60,
      "strokeColor": "#9c36b5",
      "backgroundColor": "#f3d9fa",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "boeing_worker_text",
      "type": "text",
      "x": 60,
      "y": 785,
      "width": 100,
      "height": 30,
      "text": "Boeing Worker\n(concurrency=1)",
      "fontSize": 11,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_bw_b1",
      "type": "arrow",
      "x": 170,
      "y": 800,
      "width": 30,
      "height": 0,
      "strokeColor": "#9c36b5",
      "strokeWidth": 2,
      "points": [[0, 0], [30, 0]]
    },
    {
      "id": "boeing_step1",
      "type": "rectangle",
      "x": 200,
      "y": 770,
      "width": 160,
      "height": 60,
      "strokeColor": "#9c36b5",
      "backgroundColor": "#eebefa",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "boeing_step1_text",
      "type": "text",
      "x": 210,
      "y": 780,
      "width": 140,
      "height": 40,
      "text": "CALL Boeing API\n10 SKUs per batch",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "boeing_step1_api",
      "type": "diamond",
      "x": 230,
      "y": 840,
      "width": 100,
      "height": 50,
      "strokeColor": "#9c36b5",
      "backgroundColor": "#f8f0fc",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "boeing_step1_api_text",
      "type": "text",
      "x": 250,
      "y": 855,
      "width": 60,
      "height": 20,
      "text": "Boeing API",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_b1_b2",
      "type": "arrow",
      "x": 360,
      "y": 800,
      "width": 30,
      "height": 0,
      "strokeColor": "#9c36b5",
      "strokeWidth": 2,
      "points": [[0, 0], [30, 0]]
    },
    {
      "id": "boeing_step2",
      "type": "rectangle",
      "x": 390,
      "y": 770,
      "width": 160,
      "height": 60,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#b2f2bb",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "boeing_step2_text",
      "type": "text",
      "x": 400,
      "y": 780,
      "width": 140,
      "height": 40,
      "text": "READ sync_schedule\n(get stored hash)",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "boeing_step2_db",
      "type": "ellipse",
      "x": 420,
      "y": 840,
      "width": 100,
      "height": 35,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#d3f9d8",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "boeing_step2_db_text",
      "type": "text",
      "x": 430,
      "y": 848,
      "width": 80,
      "height": 20,
      "text": "sync_schedule",
      "fontSize": 9,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_b2_b3",
      "type": "arrow",
      "x": 550,
      "y": 800,
      "width": 30,
      "height": 0,
      "strokeColor": "#9c36b5",
      "strokeWidth": 2,
      "points": [[0, 0], [30, 0]]
    },
    {
      "id": "boeing_step3",
      "type": "diamond",
      "x": 580,
      "y": 760,
      "width": 140,
      "height": 80,
      "strokeColor": "#f08c00",
      "backgroundColor": "#fff9db",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "boeing_step3_text",
      "type": "text",
      "x": 600,
      "y": 785,
      "width": 100,
      "height": 30,
      "text": "COMPARE\nHASHES",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_b3_same",
      "type": "arrow",
      "x": 650,
      "y": 840,
      "width": 0,
      "height": 40,
      "strokeColor": "#2f9e44",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 40]]
    },
    {
      "id": "boeing_same",
      "type": "rectangle",
      "x": 580,
      "y": 880,
      "width": 140,
      "height": 50,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#d3f9d8",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "boeing_same_text",
      "type": "text",
      "x": 590,
      "y": 890,
      "width": 120,
      "height": 30,
      "text": "SAME = No Change\nSkip Shopify update",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_b3_diff",
      "type": "arrow",
      "x": 720,
      "y": 800,
      "width": 30,
      "height": 0,
      "strokeColor": "#e03131",
      "strokeWidth": 2,
      "points": [[0, 0], [30, 0]]
    },
    {
      "id": "boeing_diff",
      "type": "rectangle",
      "x": 750,
      "y": 770,
      "width": 160,
      "height": 60,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffe3e3",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "boeing_diff_text",
      "type": "text",
      "x": 760,
      "y": 780,
      "width": 140,
      "height": 40,
      "text": "DIFFERENT = Changed!\nQueue Shopify update",
      "fontSize": 11,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_diff_queue",
      "type": "arrow",
      "x": 830,
      "y": 830,
      "width": 0,
      "height": 40,
      "strokeColor": "#e03131",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 40]]
    },
    {
      "id": "boeing_queue",
      "type": "rectangle",
      "x": 760,
      "y": 870,
      "width": 140,
      "height": 40,
      "strokeColor": "#f03e3e",
      "backgroundColor": "#ffe3e3",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 2 }
    },
    {
      "id": "boeing_queue_text",
      "type": "text",
      "x": 780,
      "y": 880,
      "width": 100,
      "height": 20,
      "text": "Redis: sync_shopify",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_b_update",
      "type": "arrow",
      "x": 910,
      "y": 800,
      "width": 40,
      "height": 0,
      "strokeColor": "#9c36b5",
      "strokeWidth": 2,
      "points": [[0, 0], [40, 0]]
    },
    {
      "id": "boeing_update",
      "type": "rectangle",
      "x": 950,
      "y": 770,
      "width": 180,
      "height": 60,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "boeing_update_text",
      "type": "text",
      "x": 960,
      "y": 775,
      "width": 160,
      "height": 50,
      "text": "WRITE sync_schedule\nstatus='success'\nnext_sync = +24h",
      "fontSize": 11,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "boeing_update_db",
      "type": "ellipse",
      "x": 980,
      "y": 840,
      "width": 120,
      "height": 35,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffe3e3",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "boeing_update_db_text",
      "type": "text",
      "x": 995,
      "y": 848,
      "width": 90,
      "height": 20,
      "text": "sync_schedule",
      "fontSize": 9,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "section4_title",
      "type": "text",
      "x": 50,
      "y": 960,
      "width": 600,
      "height": 30,
      "text": "FLOW 4: SHOPIFY UPDATE (Only When Data Changed ~5%)",
      "fontSize": 24,
      "fontFamily": 1,
      "strokeColor": "#0c8599",
      "backgroundColor": "transparent"
    },
    {
      "id": "shopify_worker",
      "type": "rectangle",
      "x": 50,
      "y": 1010,
      "width": 120,
      "height": 60,
      "strokeColor": "#0c8599",
      "backgroundColor": "#99e9f2",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "shopify_worker_text",
      "type": "text",
      "x": 60,
      "y": 1025,
      "width": 100,
      "height": 30,
      "text": "Shopify Worker\n(concurrency=4)",
      "fontSize": 11,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_sw_s1",
      "type": "arrow",
      "x": 170,
      "y": 1040,
      "width": 30,
      "height": 0,
      "strokeColor": "#0c8599",
      "strokeWidth": 2,
      "points": [[0, 0], [30, 0]]
    },
    {
      "id": "shopify_step1",
      "type": "rectangle",
      "x": 200,
      "y": 1010,
      "width": 160,
      "height": 60,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#b2f2bb",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "shopify_step1_text",
      "type": "text",
      "x": 210,
      "y": 1020,
      "width": 140,
      "height": 40,
      "text": "READ product_staging\n(get shopify_id)",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shopify_step1_db",
      "type": "ellipse",
      "x": 230,
      "y": 1080,
      "width": 100,
      "height": 35,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#d3f9d8",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "shopify_step1_db_text",
      "type": "text",
      "x": 235,
      "y": 1088,
      "width": 90,
      "height": 20,
      "text": "product_staging",
      "fontSize": 9,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_s1_s2",
      "type": "arrow",
      "x": 360,
      "y": 1040,
      "width": 30,
      "height": 0,
      "strokeColor": "#0c8599",
      "strokeWidth": 2,
      "points": [[0, 0], [30, 0]]
    },
    {
      "id": "shopify_step2",
      "type": "rectangle",
      "x": 390,
      "y": 1010,
      "width": 160,
      "height": 60,
      "strokeColor": "#0c8599",
      "backgroundColor": "#c5f6fa",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "shopify_step2_text",
      "type": "text",
      "x": 400,
      "y": 1020,
      "width": 140,
      "height": 40,
      "text": "Calculate price\nBoeing × 1.1 = Shopify",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_s2_s3",
      "type": "arrow",
      "x": 550,
      "y": 1040,
      "width": 30,
      "height": 0,
      "strokeColor": "#0c8599",
      "strokeWidth": 2,
      "points": [[0, 0], [30, 0]]
    },
    {
      "id": "shopify_step3",
      "type": "rectangle",
      "x": 580,
      "y": 1010,
      "width": 160,
      "height": 60,
      "strokeColor": "#9c36b5",
      "backgroundColor": "#eebefa",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "shopify_step3_text",
      "type": "text",
      "x": 590,
      "y": 1020,
      "width": 140,
      "height": 40,
      "text": "CALL Shopify API\nPUT /variants",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shopify_step3_api",
      "type": "diamond",
      "x": 610,
      "y": 1080,
      "width": 100,
      "height": 50,
      "strokeColor": "#9c36b5",
      "backgroundColor": "#f8f0fc",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "shopify_step3_api_text",
      "type": "text",
      "x": 625,
      "y": 1095,
      "width": 70,
      "height": 20,
      "text": "Shopify API",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "arrow_s3_s4",
      "type": "arrow",
      "x": 740,
      "y": 1040,
      "width": 30,
      "height": 0,
      "strokeColor": "#0c8599",
      "strokeWidth": 2,
      "points": [[0, 0], [30, 0]]
    },
    {
      "id": "shopify_step4",
      "type": "rectangle",
      "x": 770,
      "y": 1010,
      "width": 160,
      "height": 60,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "shopify_step4_text",
      "type": "text",
      "x": 780,
      "y": 1020,
      "width": 140,
      "height": 40,
      "text": "WRITE product_staging\n& product tables",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shopify_step4_db1",
      "type": "ellipse",
      "x": 770,
      "y": 1080,
      "width": 80,
      "height": 30,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffe3e3",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "shopify_step4_db1_text",
      "type": "text",
      "x": 778,
      "y": 1088,
      "width": 64,
      "height": 15,
      "text": "prod_staging",
      "fontSize": 8,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shopify_step4_db2",
      "type": "ellipse",
      "x": 860,
      "y": 1080,
      "width": 70,
      "height": 30,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffe3e3",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "shopify_step4_db2_text",
      "type": "text",
      "x": 875,
      "y": 1088,
      "width": 40,
      "height": 15,
      "text": "product",
      "fontSize": 8,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "legend_box",
      "type": "rectangle",
      "x": 1150,
      "y": 480,
      "width": 320,
      "height": 200,
      "strokeColor": "#495057",
      "backgroundColor": "#f8f9fa",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "legend_title",
      "type": "text",
      "x": 1170,
      "y": 490,
      "width": 100,
      "height": 25,
      "text": "LEGEND",
      "fontSize": 18,
      "fontFamily": 1,
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "legend_read",
      "type": "rectangle",
      "x": 1170,
      "y": 520,
      "width": 25,
      "height": 20,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#b2f2bb",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "legend_read_text",
      "type": "text",
      "x": 1200,
      "y": 522,
      "width": 100,
      "height": 18,
      "text": "= Database READ",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "legend_write",
      "type": "rectangle",
      "x": 1170,
      "y": 550,
      "width": 25,
      "height": 20,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "legend_write_text",
      "type": "text",
      "x": 1200,
      "y": 552,
      "width": 100,
      "height": 18,
      "text": "= Database WRITE",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "legend_api",
      "type": "rectangle",
      "x": 1170,
      "y": 580,
      "width": 25,
      "height": 20,
      "strokeColor": "#9c36b5",
      "backgroundColor": "#eebefa",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "legend_api_text",
      "type": "text",
      "x": 1200,
      "y": 582,
      "width": 100,
      "height": 18,
      "text": "= External API call",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "legend_db",
      "type": "ellipse",
      "x": 1170,
      "y": 610,
      "width": 25,
      "height": 20,
      "strokeColor": "#f08c00",
      "backgroundColor": "#ffec99",
      "fillStyle": "solid",
      "strokeWidth": 2
    },
    {
      "id": "legend_db_text",
      "type": "text",
      "x": 1200,
      "y": 612,
      "width": 100,
      "height": 18,
      "text": "= Database table",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "legend_redis",
      "type": "rectangle",
      "x": 1170,
      "y": 640,
      "width": 25,
      "height": 20,
      "strokeColor": "#f03e3e",
      "backgroundColor": "#ffe3e3",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 2 }
    },
    {
      "id": "legend_redis_text",
      "type": "text",
      "x": 1200,
      "y": 642,
      "width": 100,
      "height": 18,
      "text": "= Redis queue",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "stats_box",
      "type": "rectangle",
      "x": 1150,
      "y": 720,
      "width": 320,
      "height": 160,
      "strokeColor": "#495057",
      "backgroundColor": "#e9ecef",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "stats_title",
      "type": "text",
      "x": 1170,
      "y": 730,
      "width": 200,
      "height": 25,
      "text": "DAILY STATS (5K products)",
      "fontSize": 16,
      "fontFamily": 1,
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "stats_text",
      "type": "text",
      "x": 1170,
      "y": 760,
      "width": 280,
      "height": 100,
      "text": "• 24 hourly dispatches\n• 208 products/hour\n• 21 Boeing batches/hour\n• ~5% change rate → 250 Shopify updates\n• ~10,500 DB writes/day\n• ~7 writes/minute (negligible)",
      "fontSize": 12,
      "fontFamily": 1,
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "tables_box",
      "type": "rectangle",
      "x": 1150,
      "y": 920,
      "width": 320,
      "height": 200,
      "strokeColor": "#495057",
      "backgroundColor": "#fff9db",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 }
    },
    {
      "id": "tables_title",
      "type": "text",
      "x": 1170,
      "y": 930,
      "width": 200,
      "height": 25,
      "text": "TABLES WRITTEN",
      "fontSize": 16,
      "fontFamily": 1,
      "strokeColor": "#e67700"
    },
    {
      "id": "tables_text",
      "type": "text",
      "x": 1170,
      "y": 960,
      "width": 280,
      "height": 150,
      "text": "product_sync_schedule (95%)\n  • Publish → INSERT\n  • Dispatch → UPDATE (lock)\n  • Boeing sync → UPDATE (status)\n\nproduct_staging (2.5%)\n  • Publish → UPDATE\n  • Shopify sync → UPDATE\n\nproduct (2.5%)\n  • Publish → UPSERT\n  • Shopify sync → UPDATE",
      "fontSize": 11,
      "fontFamily": 1,
      "strokeColor": "#1e1e1e"
    }
  ],
  "appState": {
    "gridSize": null,
    "viewBackgroundColor": "#ffffff"
  },
  "files": {}
}
