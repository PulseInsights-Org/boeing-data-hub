{"type":"excalidraw","version":2,"source":"https://excalidraw.com","elements":[{"id":"beat","type":"rectangle","x":80,"y":60,"width":260,"height":90,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"#e3f2fd","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":{"type":3},"seed":1,"version":1,"versionNonce":1,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false},{"id":"beat_txt","type":"text","x":100,"y":85,"width":220,"height":40,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":2,"version":1,"versionNonce":2,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"text":"Celery Beat (UTC)\n:00 hourly, :30 retry","fontSize":16,"fontFamily":1,"textAlign":"center","verticalAlign":"middle","baseline":34},{"id":"dispatcher","type":"rectangle","x":80,"y":210,"width":260,"height":110,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"#fff3e0","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":{"type":3},"seed":3,"version":1,"versionNonce":3,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false},{"id":"dispatcher_txt","type":"text","x":95,"y":235,"width":230,"height":60,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":4,"version":1,"versionNonce":4,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"text":"Dispatcher Worker\n(queue: default)\nselect due + borrow pool\nbatch <=10","fontSize":15,"fontFamily":1,"textAlign":"center","verticalAlign":"middle","baseline":54},{"id":"redis","type":"rectangle","x":420,"y":210,"width":260,"height":110,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"#e8f5e9","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":{"type":3},"seed":5,"version":1,"versionNonce":5,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false},{"id":"redis_txt","type":"text","x":435,"y":235,"width":230,"height":60,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":6,"version":1,"versionNonce":6,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"text":"Redis Token Bucket\n2 tokens / minute\nacquire 1 per Boeing call\nno token => requeue 30s","fontSize":14,"fontFamily":1,"textAlign":"center","verticalAlign":"middle","baseline":52},{"id":"boeing_worker","type":"rectangle","x":420,"y":60,"width":260,"height":110,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"#f3e5f5","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":{"type":3},"seed":7,"version":1,"versionNonce":7,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false},{"id":"boeing_worker_txt","type":"text","x":435,"y":82,"width":230,"height":70,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":8,"version":1,"versionNonce":8,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"text":"Boeing Sync Worker\n(queue: sync_boeing)\nacquire token -> call Boeing\ndiff/hash -> enqueue Shopify","fontSize":14,"fontFamily":1,"textAlign":"center","verticalAlign":"middle","baseline":60},{"id":"shopify_worker","type":"rectangle","x":760,"y":60,"width":270,"height":110,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"#ffebee","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":{"type":3},"seed":9,"version":1,"versionNonce":9,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false},{"id":"shopify_worker_txt","type":"text","x":775,"y":82,"width":240,"height":70,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":10,"version":1,"versionNonce":10,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"text":"Shopify Sync Worker\n(queue: sync_shopify)\nupdate price/qty\ndraft after 5 failures\nwrite back DB","fontSize":14,"fontFamily":1,"textAlign":"center","verticalAlign":"middle","baseline":60},{"id":"supabase","type":"rectangle","x":760,"y":230,"width":270,"height":140,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"#eceff1","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":{"type":3},"seed":11,"version":1,"versionNonce":11,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false},{"id":"supabase_txt","type":"text","x":775,"y":252,"width":240,"height":96,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":1,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":12,"version":1,"versionNonce":12,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"text":"Supabase (Postgres)\nTables:\n- product_staging\n- product\n- product_sync_schedule\nreads+writes by all workers","fontSize":14,"fontFamily":1,"textAlign":"center","verticalAlign":"middle","baseline":84},{"id":"arrow1","type":"arrow","x":210,"y":150,"width":0,"height":60,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":13,"version":1,"versionNonce":13,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"points":[[0,0],[0,60]],"lastCommittedPoint":[0,60],"startBinding":{"elementId":"beat","focus":0.0,"gap":0},"endBinding":{"elementId":"dispatcher","focus":0.0,"gap":0}},{"id":"arrow2","type":"arrow","x":340,"y":265,"width":80,"height":0,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":14,"version":1,"versionNonce":14,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"points":[[0,0],[80,0]],"lastCommittedPoint":[80,0],"startBinding":{"elementId":"dispatcher","focus":0.0,"gap":0},"endBinding":{"elementId":"redis","focus":0.0,"gap":0}},{"id":"arrow3","type":"arrow","x":340,"y":250,"width":80,"height":-120,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":15,"version":1,"versionNonce":15,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"points":[[0,0],[80,-120]],"lastCommittedPoint":[80,-120],"startBinding":{"elementId":"dispatcher","focus":0.2,"gap":0},"endBinding":{"elementId":"boeing_worker","focus":-0.2,"gap":0}},{"id":"arrow4","type":"arrow","x":680,"y":115,"width":80,"height":0,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":16,"version":1,"versionNonce":16,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"points":[[0,0],[80,0]],"lastCommittedPoint":[80,0],"startBinding":{"elementId":"boeing_worker","focus":0.0,"gap":0},"endBinding":{"elementId":"shopify_worker","focus":0.0,"gap":0}},{"id":"arrow5","type":"arrow","x":550,"y":170,"width":0,"height":40,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":17,"version":1,"versionNonce":17,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"points":[[0,0],[0,40]],"lastCommittedPoint":[0,40],"startBinding":{"elementId":"boeing_worker","focus":0.0,"gap":0},"endBinding":{"elementId":"redis","focus":0.0,"gap":0}},{"id":"arrow6","type":"arrow","x":895,"y":170,"width":0,"height":60,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":18,"version":1,"versionNonce":18,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"points":[[0,0],[0,60]],"lastCommittedPoint":[0,60],"startBinding":{"elementId":"shopify_worker","focus":0.0,"gap":0},"endBinding":{"elementId":"supabase","focus":0.0,"gap":0}},{"id":"arrow7","type":"arrow","x":210,"y":320,"width":550,"height":0,"angle":0,"strokeColor":"#1e1e1e","backgroundColor":"transparent","fillStyle":"solid","strokeWidth":2,"strokeStyle":"solid","roughness":0,"opacity":100,"groupIds":[],"roundness":null,"seed":19,"version":1,"versionNonce":19,"isDeleted":false,"boundElements":[],"updated":1,"link":null,"locked":false,"points":[[0,0],[550,0]],"lastCommittedPoint":[550,0],"startBinding":{"elementId":"dispatcher","focus":1.0,"gap":0},"endBinding":{"elementId":"supabase","focus":-1.0,"gap":0}}],"appState":{"viewBackgroundColor":"#ffffff","gridSize":null},"files":{}}
