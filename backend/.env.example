# AWS Cognito Configuration (for SSO authentication)
COGNITO_REGION=us-east-1
COGNITO_USER_POOL_ID=us-east-1_XXXXXXXXX
COGNITO_APP_CLIENT_ID=your-app-client-id

# Aviation Gateway (for auth redirects)
AVIATION_GATEWAY_URL=http://localhost:8080

# AWS S3 Configuration
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key
AWS_REGION=us-east-1
S3_BUCKET_NAME=your-s3-bucket-name

# Supabase Configuration
DATABASE_URL=https://your-project-id.supabase.co
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
SUPABASE_ANON_KEY=your-anon-key
SUPABASE_STORAGE_BUCKET=product-images

# Shopify Configuration
SHOPIFY_STORE_DOMAIN=your-store.myshopify.com
SHOPIFY_ADMIN_API_TOKEN=your-admin-api-token
SHOPIFY_API_KEY=your-shopify-api-key
SHOPIFY_API_SECRET=your-shopify-api-secret
SHOPIFY_API_VERSION=2025-01
SHOPIFY_LOCATION_MAP={}
# Map Boeing location names to your 3-char inventory location codes (for metafield)
# Example: {"Dallas Central": "1D1", "Chicago Warehouse": "CHI", "Main": "MN1"}
SHOPIFY_INVENTORY_LOCATION_CODES={}

# Boeing API Configuration
BOEING_CLIENT_ID=your-boeing-client-id
BOEING_CLIENT_SECRET=your-boeing-client-secret
BOEING_SCOPE=api://helixapis.com/.default
BOEING_OAUTH_TOKEN_URL=https://api.developer.boeingservices.com/oauth2/v2.0/token
BOEING_PNA_OAUTH_URL=https://api.developer.boeingservices.com/boeing-part-price-availability/token/v1/oauth
BOEING_PNA_PRICE_URL=https://api.developer.boeingservices.com/boeing-part-price-availability/price-availability/v1/wtoken
BOEING_USERNAME=your-boeing-username
BOEING_PASSWORD=your-boeing-password
BOEING_CLIENT_JWK_JSON={"kty":"RSA","kid":"KEY_ID","use":"sig","alg":"RS256","n":"...","e":"AQAB","d":"...","p":"...","q":"...","dp":"...","dq":"...","qi":"..."}

# ============================================
# REDIS CONFIGURATION
# ============================================
REDIS_URL=redis://localhost:6379/0

# ============================================
# CELERY CONFIGURATION
# ============================================
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Worker concurrency settings
CELERY_EXTRACTION_CONCURRENCY=2
CELERY_NORMALIZATION_CONCURRENCY=4
CELERY_SHOPIFY_CONCURRENCY=1

# ============================================
# BATCH PROCESSING SETTINGS
# ============================================
# Chunk size for Boeing API calls (start with 10, can increase to 20 if stable)
BOEING_BATCH_SIZE=10

# Maximum allowed items per request
MAX_BULK_SEARCH_SIZE=50000
MAX_BULK_PUBLISH_SIZE=10000

# ============================================
# RATE LIMITING
# ============================================
BOEING_API_RATE_LIMIT=20/m
SHOPIFY_API_RATE_LIMIT=30/m

# ============================================
# SYNC SCHEDULER CONFIGURATION
# ============================================
# Auto-start Celery worker and beat with FastAPI (set to false to run manually)
AUTO_START_CELERY=true

# SYNC MODE: "production" or "testing"
# - production: Uses hour buckets (0-23), dispatch at :45 of each hour
# - testing: Uses minute buckets (0-5), dispatch every 10 minutes
#
# TESTING MODE is useful for:
# - Faster sync cycles (every 10 min instead of hourly)
# - Debugging sync dispatcher logic
# - Verifying sync flow end-to-end
#
# Set to "production" for normal operations
SYNC_MODE=testing

# Number of minute buckets for testing mode (default: 6 for 10-min intervals)
# Bucket 0 = minutes 0-9, Bucket 1 = minutes 10-19, etc.
SYNC_TEST_BUCKET_COUNT=6

# When to run sync dispatch (crontab minute syntax)
# PRODUCTION: 45 (runs once at XX:45 every hour)
# TESTING:    */10 (runs every 10 minutes, auto-set when SYNC_MODE=testing)
# TESTING:    */5 (runs every 5 minutes)
# Note: This is auto-configured based on SYNC_MODE if not set
SYNC_DISPATCH_MINUTE=*/10

# Hours between retry attempts for failed products
# Default: 4 (retries every 4 hours)
# For TESTING: Set to 1 for faster retries
SYNC_RETRY_HOURS=4

# Hour (UTC) to run daily cleanup (0-23)
# Default: 0 (midnight UTC)
SYNC_CLEANUP_HOUR=0

# Products per Boeing API batch call
# Default: 10 (Boeing's recommended max)
SYNC_BATCH_SIZE=10

# Consecutive failures before marking product as inactive
# Default: 5
SYNC_MAX_FAILURES=5

# Boeing Rate Limiter (Token Bucket)
# Capacity: Max tokens (burst capacity)
# Refill: Tokens added per minute
BOEING_RATE_LIMIT_CAPACITY=2
BOEING_RATE_LIMIT_REFILL=2

# Rate limits for Celery tasks
BOEING_RATE_LIMIT=2/m
SHOPIFY_RATE_LIMIT=30/m
